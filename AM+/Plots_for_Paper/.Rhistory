p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(125,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(121,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(125,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(121,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(125,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(121,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(125,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(121,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(125,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(121,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p_mem
p_mem
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(129,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(125,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=125), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(129,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(123,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
p <- ggplot(df, aes(x=Pop, y=mem, group=method, colour=method)) +
geom_line(size=2) + geom_point(aes(colour=method),size=5) +
# scale_shape_manual(values=1:nlevels(df$method)) +
scale_colour_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("Eagle","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values=brewer.pal(9, "Paired")) +
scale_shape_manual(breaks=c("am.", "bigRR", "glmnet", "lasso", "mlmm", "r2VIM", "gemma", "fastALL", "fast"),
labels=c("AMplus","bigRR", "glmnet", "LMM-Lasso", "MLMM", "r2VIM", "GEMMA", bquote("FaST-LMM"^all),
bquote("FaST-LMM"^few)),
values = c(19,19,19,19,19,17,17,17,19)) +
scale_size(guide = 'none')  + scale_y_continuous(limits = c(0, 130))
p  <- p +  geom_segment(aes(x=7.5e5, y=0,xend=7.5e5,yend=127), colour="grey", cex=0.5) +
geom_segment(aes(x=7.5e7, y=0,xend=7.5e7,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=1.4e8, y=0,xend=1.4e8,yend=127), colour="grey", cex=0.5) +
geom_segment(aes(x=1.0e9, y=0,xend=1.0e9,yend=120), colour="grey", cex=0.5) +
geom_segment(aes(x=6.0e9, y=0,xend=6.0e9,yend=127), colour="grey", cex=0.5) +
geom_segment(aes(x=1.5e10,y=0,xend=1.5e10,yend=120), colour="grey", cex=0.5)
## log log scale
p  <- p + scale_x_continuous(trans="log10", limits=c(500000, 1e11),
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))
)
##log tick marks
p <- p +annotation_logticks(scale=TRUE, side="b")
## make more room around plot
p <- p + theme(plot.margin = grid::unit(c(1,0,4,1), "lines"))
## set theme
p <-  p + theme_classic()
## specify xlab and ylab
p <- p  + ylab(bquote("Memory usage (in GB)")) +
xlab(bquote('\nNumber of genotypes'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=14,  angle=0)) +
theme(axis.text.y=element_text(size=sizefn, hjust=0.5))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=sizefn))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## add text to plots
p <- p +  annotate("text", x=pps, y=rep(129,length(pps)), label= c("150x5K" ,
"",
"350x400K" ,
"",
"4000x1.5M",
""),
size=5)
p <- p +  annotate("text", x=pps, y=rep(123,length(pps)), label= c("" ,
"1500x50K",
"" ,
"2000x500K",
"",
"10000x1.5M"),
size=5)
p <- p + theme(legend.position = c(0.84, 0.6),
legend.justification = c(0, 1))
# remove x axis labels
#p <- p + theme(axis.text.x=element_blank(),axis.title.x=element_blank())
## putting some space around the plot
p <- p + theme(plot.margin = grid::unit(c(1,5,1,1), "lines"))
## square plot
p <- p + theme(aspect.ratio=1)
p_mem <- p
p_mem
postscript("~/Papers/AM-Paper/mem.eps", width=10, height=10,
horizontal=FALSE)
p_mem
dev.off()
699/60
