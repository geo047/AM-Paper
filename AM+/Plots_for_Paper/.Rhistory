guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA, NA))))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=44))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=44))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=40,  angle=0)) +
theme(axis.text.y=element_text(size=40, hjust=0.5)) +
theme(strip.text = element_text(size=40))
## increase font of lengend + remove legend title
p <- p +  theme(legend.position="none")
## xlimit
p <- p + coord_cartesian(xlim = c(0, 1), ylim=c(0, 1) )
p <- p + theme(panel.background = element_rect(fill="white"))
return(p)
}
df1 <- subset(dfres, (method=="GEMMA" | method=="FaST-LMM^few" | method=="FaST-LMM^all" ))
df2 <- subset(dfres, method=="AMplus" | method=="MLMM")
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1.5, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p <- p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(12, "Paired")[c(1,7,6,12,2)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
## set theme
p <- p + theme_hc()
## increase spacing between facet plots
p <- p + theme(panel.spacing = unit(3, "lines"))
## specify xlab and ylab
p <- p  + ylab(bquote("Power")) +
xlab(bquote('False discovery rate'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=28))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=28))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=24,  angle=0)) +
theme(axis.text.y=element_text(size=24, hjust=0.5)) +
theme(strip.text = element_text(size=24))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=12))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## xlimit
p <- p + coord_cartesian(xlim = c(0, 0.05), ylim=c(0, 1))
## increase font of lengend + remove legend title
p <- p +  theme(legend.position="none")
## xlimit
p <- p + coord_cartesian(xlim = c(0, 1), ylim=c(0, 1) )
p <- p + theme(panel.background = element_rect(fill="white"))
p
dfres
df1 <- subset(dfres, (method=="GEMMA" | method=="FaST-LMM^few" | method=="FaST-LMM^all" ))
df2 <- subset(dfres, method=="AMplus" | method=="MLMM")
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1.5)  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p
df1
df2
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1.5)  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
p
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
p
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
levels(df2$method)
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1.5, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p <- p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
print(p)
p <- p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,1,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
print(p)
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,9,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,1,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(1,2,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(1,1,2,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(1,1,1,2,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(1,1,1,1,2)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,9,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,10,1,1,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,10,9,7,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
df1 <- subset(dfres, (method=="GEMMA" | method=="FaST-LMM^few" | method=="FaST-LMM^all" ))
df2 <- subset(dfres, method=="AMplus" | method=="MLMM")
#p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1.5)  +
#  geom_point(data=df2, aes(FDR, recall), size=1.5) +
#  facet_wrap(~fam, ncol=3) +
#  theme(aspect.ratio = 1) # try with and without
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1.5, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p <- p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,10,9,7,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
print(p)
## set theme
p <- p + theme_hc()
## increase spacing between facet plots
p <- p + theme(panel.spacing = unit(3, "lines"))
## specify xlab and ylab
p <- p  + ylab(bquote("Power")) +
xlab(bquote('False discovery rate'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=16))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=16))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=12,  angle=0)) +
theme(axis.text.y=element_text(size=12, hjust=0.5)) +
theme(strip.text = element_text(size=12))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=12))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
p
## xlimit
p <- p + coord_cartesian(xlim = c(0, 0.05), ylim=c(0, 1))
## increase font of lengend + remove legend title
#p <- p +  theme(legend.position="none")
## xlimit
p <- p + coord_cartesian(xlim = c(0, 1), ylim=c(0, 1) )
p
p
p + theme(panel.background = element_rect(fill="white"))
p
p + theme(panel.background = element_rect(fill="white"))
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
library(RColorBrewer)
library(extrafont)
DIR <- paste(getwd(),"/", sep="")
DIR <- "/Users/geo047/Papers/AM-Paper/AM+/Plots_for_Paper/"
sizefn <- 16
#thresh_indx <- 1:100
thresh_indx <- 1:100
## vector initialisation
fam <- c("W", "S",  "L","HS","A","HL")
names.of.methods <- c("am", "mlmm","glmnet","lasso","r2VIM","bigRR", "gemma", "fastALL", "fast")
FDR <- list()
recall <- list()  ## == power
dfres <- list()
##----------------------------------------
## Forming list with FDR and recall(power)
## results over families and threshold indexes
##------------------------------------------
cat(" Forming FDR and power(recall) results ... \n")
## looping over families
for(ff in fam){
FDR[[ff]] <- list()
recall[[ff]] <- list()
## looing over threshold indexes
for(indx in thresh_indx){
FDR[[ff]][[indx]] <- list()
recall[[ff]][[indx]] <- list()
## Load Data RData Objects
filename <- paste(DIR,"res",ff,"_",indx, ".RData", sep="")
load(filename)   #  # loads res_mat
for(ii in names.of.methods){
n_method <- paste("n_",ii, sep="")
nQTL_method <- paste("nQTL_",ii, sep="")
## ---- Set Power (recall) and FDR
tmp <-  1 - (mat[, eval(nQTL_method)]/
mat[, eval(n_method)])
tmp[is.nan(tmp)] <- 0
FDR[[ff]][[indx]][[ii]] <- mean(tmp, na.rm=TRUE)
# capturing case where there may not be any results
if(is.nan(FDR[[ff]][[indx]][[ii]]))
FDR[[ff]][[indx]][[ii]] <- NA
recall[[ff]][[indx]][[ii]] <- mean(mat[,eval(nQTL_method)]   / mat[, "nQTL_true"],
na.rm=TRUE)
if(is.nan(recall[[ff]][[indx]][[ii]]))
recall[[ff]][[indx]][[ii]] <- NA
}  ## end for ii
} ## end for  indx
} ## end for family
## form results structure
## method,  fam,  rep,  FDR
dfres <- data.frame()
## looping over families
for(ff in names(FDR))
{
cat(" Reading in family", ff, "\n")
## looping over threshold indexes
for(indx in thresh_indx)
{
## looping over methods
for(mm in names(FDR[[1]][[1]])){
df <- data.frame(method=mm, fam=ff, rep=1:length(FDR[[1]][[1]][[1]]),
FDR=FDR[[ff]][[indx]][[mm]] ,
recall = recall[[ff]][[indx]][[mm]] )
dfres <- rbind.data.frame(dfres , df)
} ## end for thresh_indx
}  ## end for mm
}  ## end for ff
dfres$FDR[which(is.nan(dfres$FDR))] <- 0
dfres$recall[which(is.nan(dfres$recall))] <- 0
## change ordering of factor levels to change order of facet_wrap
dfres$method <- factor(dfres$method, levels=c("am", "mlmm",   "glmnet", "lasso",  "r2VIM",  "bigRR", "gemma",
"fastALL", "fast"))
levels(dfres$method) <- c("AMplus", "MLMM", "glmnet", "LMM-Lasso", "r2VIM", "bigRR", "GEMMA", "FaST-LMM^all",
"FaST-LMM^few")
levels(dfres$fam) <- c("150 x 5K", "350 x 500K", "1500 x 50K", "2000 x 500K",
"4000 x 1.5M", "10000 x 1.5M")
# remove any 0's
indx <- which(dfres$FDR==0  )
dfres <- dfres[-indx,]
# stop()
indx <- which(dfres$fam=="150 x 5K" & dfres$method=="glmnet")
df1 <- subset(subset(dfres, !(method=="AMplus" | method=="MLMM" | method=="GEMMA" | method=="FaST-LMM^few" | method=="FaST-LMM^all" )),
!(fam=="4000 x 1.5M" | fam=="10000 x 1.5M"))
df2 <- subset(subset(dfres, method=="AMplus" | method=="MLMM"),  !(fam=="4000 x 1.5M" | fam=="10000 x 1.5M"))
library(RColorBrewer)
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
df1
indx <- which(df1$fam=="1500 x 50K")
df1[indx,]
bb <- df1[indx,]
head(bb)
indx <- which(bb$method=="r2VIM")
bb[indx,]
cc <- bb[indx,]
cc[order(cc$FDR),]
dd <- cc[order(cc$FDR),]
plot(dd$FDR, dd$recall)
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1)  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
require(mgcv)
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, formula = y ~ s(x), se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, formula = y ~ s(x, k=2), se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, formula = y ~ s(x, k=3), se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, formula = y ~ s(x, k=4), se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1)  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, formula = y ~ s(x, k=4), se=FALSE, method="gam")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=2) +
theme(aspect.ratio = 1) # try with and without
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
grid.newpage()
library(grid)
grid.newpage()
grid.draw(cbind(ggplotGrob(p_time), ggplotGrob(p_abstime), size = "last"))
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/time_and_mem_plot_for_paper.R')
grid.newpage()
grid.draw(cbind(ggplotGrob(p_time), ggplotGrob(p_abstime), size = "last"))
# dev.off()
grid.newpage()
grid.draw(rbind(ggplotGrob(p_time), ggplotGrob(p_abstime), size = "last"))
grid.newpage()
grid.draw(rbind(ggplotGrob(p_time), ggplotGrob(p_abstime), size = "last"))
grid.newpage()
grid.draw(rbind(ggplotGrob(p_time), ggplotGrob(p_abstime), size = "last"))
postscript("~/Papers/AM-Paper/time.eps", width=10, height=10,
horizontal=FALSE)
grid.newpage()
grid.draw(rbind(ggplotGrob(p_time), ggplotGrob(p_abstime), size = "last"))
dev.off()
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
source('~/Papers/AM-Paper/AM+/Plots_for_Paper/power_plots.R')
df1 <- subset(dfres, (method=="GEMMA" | method=="FaST-LMM^few" | method=="FaST-LMM^all" ))
df2 <- subset(dfres, method=="AMplus" | method=="MLMM")
#p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1.5)  +
#  geom_point(data=df2, aes(FDR, recall), size=1.5) +
#  facet_wrap(~fam, ncol=3) +
#  theme(aspect.ratio = 1) # try with and without
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1.5, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p <- p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,10,9,7,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,5,9,7,1)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,10,9,7,11)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "blank", "solid", "solid", "solid"),
shape=c(16, 16, NA, NA, NA))))
df1 <- subset(dfres, (method=="GEMMA" | method=="FaST-LMM^few" | method=="FaST-LMM^all" ))
df2 <- subset(dfres, method=="AMplus")
#p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_line(size=1.5)  +
#  geom_point(data=df2, aes(FDR, recall), size=1.5) +
#  facet_wrap(~fam, ncol=3) +
#  theme(aspect.ratio = 1) # try with and without
p <- ggplot(data=df1, aes(FDR, recall, color=method)) + geom_smooth(size=1.5, se=FALSE, method="loess")  +
geom_point(data=df2, aes(FDR, recall), size=1.5) +
facet_wrap(~fam, ncol=3) +
theme(aspect.ratio = 1) # try with and without
p <- p + scale_color_manual(
breaks=c("AMplus","MLMM","FaST-LMM^all","FaST-LMM^few","GEMMA"),
labels=c("Eagle", "MLMM", bquote("FaST-LMM"^all), bquote("FaST-LMM"^few), "GEMMA"),
values=brewer.pal(10, "Paired")[c(2,10,9,7)],
guide = guide_legend(override.aes = list(
linetype = c("blank", "solid", "solid", "solid"),
shape=c(16, NA, NA, NA))))
p
## set theme
p <- p + theme_hc()
## increase spacing between facet plots
p <- p + theme(panel.spacing = unit(3, "lines"))
## specify xlab and ylab
p <- p  + ylab(bquote("Power")) +
xlab(bquote('False discovery rate'))
##  change x and y labels size and bold
p <- p + theme(axis.title.x = element_text(angle=0, vjust=1, size=12))
p <- p + theme(axis.title.y = element_text(angle=90, vjust=1, size=12))
# alter x and y axis labels
p <- p +
theme(axis.text.x = element_text(size=10,  angle=0)) +
theme(axis.text.y=element_text(size=10, hjust=0.5)) +
theme(strip.text = element_text(size=10))
## increase font of lengend + remove legend title
p <- p +  theme(legend.text=element_text(size=10))
p <- p +  theme(legend.title=element_blank())
p <- p+ theme(legend.key.width=grid:::unit(1.5,"cm"))
## xlimit
p <- p + coord_cartesian(xlim = c(0, 1), ylim=c(0, 1))
## increase font of lengend + remove legend title
#p <- p +  theme(legend.position="none")
## xlimit
p <- p + coord_cartesian(xlim = c(0, 0.1), ylim=c(0, 1) )
p <- p + theme(panel.background = element_rect(fill="white"))
# change number of digits in labels on x-axis
scaleFUN <- function(x) sprintf("%.2f", x)
p <- p + scale_x_continuous(labels=scaleFUN)
postscript("~/Papers/AM-Paper/power2main.eps", width=10, height=10,  fonts=c("sans"),
horizontal=FALSE)
# square plot
print(p)
dev.off()
p
